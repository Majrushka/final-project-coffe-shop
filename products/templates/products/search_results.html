{% extends 'products/base.html' %}

{% block content %}
<div class="search-results">
    <h1>Результаты поиска</h1>

    {% if results %}
        <!-- Автоматическое перенаправление обрабатывается во views -->
        <p>Найдено товаров: {{ results|length }}</p>
        <p>Если найден один товар, вы будете автоматически перенаправлены на его страницу.</p>
    {% else %}
        {% if query %}
            <p>По вашему запросу "{{ query }}" ничего не найдено.</p>
            <p>Попробуйте изменить поисковый запрос или посмотрите наши <a href="{% url 'coffee_list' %}">кофе</a>, <a href="{% url 'tea_list' %}">чай</a> или <a href="{% url 'syrup_list' %}">сиропы</a>.</p>
        {% else %}
            <p>Введите поисковый запрос в форме выше.</p>
        {% endif %}
    {% endif %}
</div>

<!-- Блок для автоматического перенаправления -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const urlParams = new URLSearchParams(window.location.search);
    const query = urlParams.get('q');
    
    if (query) {
        const lowerQuery = query.toLowerCase();
        
        if (['кофе', 'coffee'].includes(lowerQuery)) {
            window.location.href = "{% url 'coffee_list' %}";
        } else if (['чай', 'чаи', 'tea'].includes(lowerQuery)) {
            window.location.href = "{% url 'tea_list' %}";
        } else if (['сироп', 'сиропы', 'syrup'].includes(lowerQuery)) {
            window.location.href = "{% url 'syrup_list' %}";
        }
    }
});
</script>

<style>
.search-results {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

.products-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 20px;
    margin-top: 20px;
}

.product-item {
    border: 1px solid #ddd;
    padding: 15px;
    border-radius: 5px;
    text-align: center;
}

.product-item h3 {
    margin-top: 0;
    color: #2c5aa0;
}

.product-item a {
    text-decoration: none;
}

.product-item a:hover h3 {
    color: #28a745;
}

.available {
    color: #28a745;
    font-weight: bold;
}

.not-available {
    color: #dc3545;
    font-weight: bold;
}
</style>
{% endblock %}